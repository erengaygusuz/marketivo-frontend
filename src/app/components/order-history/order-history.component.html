<div class="card">
    <div class="flex justify-between items-center mb-4">
        <div class="font-semibold text-xl">Your Orders</div>
        <button class="btn btn-outline-primary" (click)="refreshOrders()" 
                [disabled]="isLoading" style="padding: 0.5rem 1rem; border: 1px solid #007bff; background: transparent; color: #007bff; border-radius: 4px; cursor: pointer;">
            <i class="pi pi-refresh" [class.pi-spin]="isLoading"></i>
            <span class="ml-2">{{ isLoading ? 'Loading...' : 'Refresh' }}</span>
        </button>
    </div>
    
    <!-- Loading State -->
    @if (isLoading) {
        <div class="text-center py-4">
            <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
            <p class="mt-2">Loading your orders...</p>
        </div>
    }
    
    <!-- Error State -->
    @if (!isLoading && errorMessage) {
        <div>
            <p-message severity="error" [closable]="false">
                <ng-template pTemplate>
                    <span>{{ errorMessage }}</span>
                </ng-template>
            </p-message>
        </div>
    }
    
    <!-- Orders Table -->
    @if (!isLoading && !errorMessage && orderHistoryList.length > 0) {
        <div>
            <p-table [value]="orderHistoryList" [scrollable]="true" scrollHeight="680px"
                [tableStyle]="{ 'min-width': '60rem' }">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 25%">Order Tracking Number</th>
                        <th style="width: 25%">Total Price</th>
                        <th style="width: 25%">Total Quantity</th>
                        <th style="width: 25%">Date</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-order>
                    <tr>
                        <td>{{ order.orderTrackingNumber }}</td>
                        <td>{{ order.totalPrice | currency: 'USD' }}</td>
                        <td>{{ order.totalQuantity }}</td>
                        <td>{{ order.dateCreated | date:'medium' }}</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    }
    
    <!-- No Orders Found -->
    @if (!isLoading && !errorMessage && orderHistoryList.length === 0) {
        <div>
            <p-message severity="info" [closable]="false">
                <ng-template pTemplate>
                    <span>No orders found. Start shopping to see your order history!</span>
                </ng-template>
            </p-message>
        </div>
    }
</div>