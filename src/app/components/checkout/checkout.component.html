<p-fluid>
    <form [formGroup]="checkoutFormGroup" (ngSubmit)="onSubmit()">
        <div class="flex" formGroupName="customer">
            <div class="card flex flex-col gap-6 w-full">
                <div class="font-semibold text-xl">Customer</div>
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="flex flex-wrap gap-2 w-full">
                        <label for="firstname2">Firstname</label>
                        <input pInputText id="firstname2" type="text" formControlName="firstName" />
                        @if (hasFieldError(firstName)) {
                        <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(firstName) }}</p-message>
                        }
                    </div>
                    <div class="flex flex-wrap gap-2 w-full">
                        <label for="lastname2">Lastname</label>
                        <input pInputText id="lastname2" type="text" formControlName="lastName" />
                        @if (hasFieldError(lastName)) {
                        <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(lastName) }}</p-message>
                        }
                    </div>
                </div>

                <div class="flex flex-wrap gap-2 ">
                    <label for="email">Email</label>
                    <input pInputText id="email" type="text" formControlName="email" />
                    @if (hasFieldError(email)) {
                    <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(email) }}</p-message>
                    }
                </div>
            </div>
        </div>
        <div class="flex mt-8">
            <div class="card flex flex-col gap-6 w-full">
                <div class="font-semibold text-xl">Shipping Address</div>
                <div formGroupName="shippingAddress">
                    <div class="flex flex-col md:flex-row gap-6 mb-4">
                        <div class="flex flex-wrap gap-2 w-full">
                            <label for="country">Country</label>
                            <p-select id="country" [options]="countries" optionLabel="name" placeholder="Select One"
                                class="w-full" (onChange)="getStates('shippingAddress')"
                                formControlName="country"></p-select>
                            @if (hasFieldError(shippingAddressCountry)) {
                            <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(shippingAddressCountry) }}</p-message>
                            }
                        </div>
                        <div class="flex flex-wrap gap-2 w-full">
                            <label for="state">State</label>
                            <p-select id="state" [options]="shippingAddressStates" optionLabel="name"
                                placeholder="Select One" class="w-full" formControlName="state"></p-select>
                            @if (hasFieldError(shippingAddressState)) {
                            <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(shippingAddressState) }}</p-message>
                            }
                        </div>
                    </div>
                    <div class="flex flex-col md:flex-row gap-6 mb-4">
                        <div class="flex flex-wrap gap-2 w-full">
                            <label for="city">City</label>
                            <input pInputText id="city" type="text" formControlName="city" />
                            @if (hasFieldError(shippingAddressCity)) {
                            <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(shippingAddressCity) }}</p-message>
                            }
                        </div>
                        <div class="flex flex-wrap gap-2 w-full">
                            <label for="street">Street</label>
                            <input pInputText id="street" type="text" formControlName="street" />
                            @if (hasFieldError(shippingAddressStreet)) {
                            <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(shippingAddressStreet) }}</p-message>
                            }
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <label for="zipCode">Zip Code</label>
                        <input pInputText id="zipCode" type="text" formControlName="zipCode" />
                        @if (hasFieldError(shippingAddressZipCode)) {
                        <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(shippingAddressZipCode) }}</p-message>
                        }
                    </div>
                </div>
                <div class="flex flex-col md:flex-row gap-4 mt-4">
                    <div class="flex items-center">
                        <p-checkbox id="checkOption1" name="option" value=""
                            (onChange)="copyShippingAddressToBillingAddress($event)" />
                        <label for="checkOption1" class="ml-2">Billing Address same as Shipping Address</label>
                    </div>
                </div>
                <div class="mt-8 font-semibold text-xl">Billing Address</div>
                <div formGroupName="billingAddress">
                    <div class="flex flex-col md:flex-row gap-6 mb-4">
                        <div class="flex flex-wrap gap-2 w-full">
                            <label for="country">Country</label>
                            <p-select id="country" [options]="countries" optionLabel="name" placeholder="Select One"
                                class="w-full" (onChange)="getStates('billingAddress')"
                                formControlName="country"></p-select>
                            @if (hasFieldError(billingAddressCountry)) {
                            <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(billingAddressCountry) }}</p-message>
                            }
                        </div>
                        <div class="flex flex-wrap gap-2 w-full">
                            <label for="state">State</label>
                            <p-select id="state" [options]="billingAddressStates" optionLabel="name"
                                placeholder="Select One" class="w-full" formControlName="state"></p-select>
                            @if (hasFieldError(billingAddressState)) {
                            <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(billingAddressState) }}</p-message>
                            }
                        </div>
                    </div>
                    <div class="flex flex-col md:flex-row gap-6 mb-4">
                        <div class="flex flex-wrap gap-2 w-full">
                            <label for="city">City</label>
                            <input pInputText id="city" type="text" formControlName="city" />
                            @if (hasFieldError(billingAddressCity)) {
                            <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(billingAddressCity) }}</p-message>
                            }
                        </div>
                        <div class="flex flex-wrap gap-2 w-full">
                            <label for="street">Street</label>
                            <input pInputText id="street" type="text" formControlName="street" />
                            @if (hasFieldError(billingAddressStreet)) {
                            <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(billingAddressStreet) }}</p-message>
                            }
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <label for="billingZipCode">Zip Code</label>
                        <input pInputText id="billingZipCode" type="text" formControlName="zipCode" />
                        @if (hasFieldError(billingAddressZipCode)) {
                        <p-message severity="error" size="small" variant="simple">{{ getFieldErrorMessage(billingAddressZipCode) }}</p-message>
                        }
                    </div>
                </div>
            </div>
        </div>
        <div class="flex mt-8" formGroupName="creditCard">
            <div class="card flex flex-col gap-6 w-full">
                <div class="font-semibold text-xl">Credit or Debit Card</div>
                <div class="flex flex-col md:flex-row gap-6">
                    <div id="card-element-wrapper" style="width: 100%;">
                        <div id="card-element" style="padding: 12px; border: 1px solid #ccc; border-radius: 4px;"
                            class="mb-2"></div>
                        @if (displayError) {
                            <p-message severity="error" size="small" variant="simple">{{ displayError }}</p-message>
                        }
                    </div>
                </div>
            </div>
        </div>
        <div class="flex mt-8">
            <div class="card flex flex-col gap-6 w-full">
                <div class="font-semibold text-xl">Review Your Order</div>
                <div class="flex flex-col gap-3">
                    <p><span class="font-semibold">Total Quantity:</span> {{ totalQuantity }}</p>
                    <p><span class="font-semibold">Shipping:</span> FREE</p>
                    <p><span class="font-semibold">Total Price:</span> {{ totalPrice | currency: 'USD' }}</p>
                </div>
                <div class="flex justify-content-center mt-4">
                    <button pButton type="submit" label="Purchase" class="p-button-info" [disabled]="isDisabled"></button>
                </div>
            </div>
        </div>
    </form>
</p-fluid>