<div class="card">
    <div class="font-semibold text-xl mb-4">Cart Details</div>
    <div *ngIf="cartItems.length > 0">
        <p-table [value]="cartItems" [scrollable]="true" scrollHeight="600px" rowGroupMode="subheader"
            [tableStyle]="{ 'min-width': '60rem' }">
            <ng-template #header>
                <tr>
                    <th>Product Image</th>
                    <th>Product Detail</th>
                    <th></th>
                </tr>
            </ng-template>
            <ng-template #groupfooter let-product>
                <tr class="sticky bottom-0 z-2" style="background: #fff;">
                    <td colspan="2"></td>
                    <td class="font-bold p-3 pb-0 text-right align-middle">
                        <div class="mb-2 font-bold text-lg">Total Quantity: {{ totalQuantity }}</div>
                        <div class="mb-2 font-bold text-lg">Shipping: FREE</div>
                        <div class="mb-2 font-bold text-lg" style="color:#1e3a8a;">Total Price: {{ totalPrice | currency: 'USD' }}</div>
                        <div class="flex justify-content-end mt-2">
                            <p-button label="Checkout" icon="pi pi-credit-card" [routerLink]="['/checkout']"
                                class="w-full max-w-12rem text-base py-2" styleClass="p-button-success p-button-md"></p-button>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template #body let-product let-rowIndex="rowIndex">
                <tr>
                    <td>
                        <img [alt]="product.name" src="{{ product.imageUrl }}" width="150"
                            style="vertical-align: middle" />
                    </td>
                    <td>
                        <div class="flex flex-col gap-2">
                            <span class="text-lg font-semibold">{{ product.name }}</span>
                            <span class="text-black text-lg font-semibold">{{ product.unitPrice | currency: 'USD'
                                }}</span>
                        </div>
                    </td>
                    <td>
                        <div class="items">
                            <label class="font-bold">Quantity:</label>
                            <div class="flex items-center gap-2 justify-start mt-4">
                                <p-button 
                                    icon="pi pi-plus" 
                                    (onClick)="incrementQuantity(product)"
                                    styleClass="p-button-sm p-button-rounded"
                                    [style]="{'background':'#1e3a8a','borderColor':'#1e3a8a','color':'#fff'}"
                                ></p-button>
                                <span class="text-center font-semibold w-8">{{ product.quantity }}</span>
                                <p-button 
                                    icon="pi pi-minus" 
                                    (onClick)="decrementQuantity(product)"
                                    styleClass="p-button-sm p-button-rounded"
                                    [style]="{'background':'#1e3a8a','borderColor':'#1e3a8a','color':'#fff'}"
                                ></p-button>
                            </div>
                            <div class="flex justify-start mt-4">
                                <p-button 
                                    icon="pi pi-trash" 
                                    label="Remove" 
                                    (onClick)="remove(product)"
                                    styleClass="p-button-sm p-button-danger"
                                ></p-button>
                            </div>
                            <div class="mt-4 text-base font-semibold text-black">
                                Subtotal: {{ product.quantity * product.unitPrice | currency: 'USD' }}
                            </div>
                        </div>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
    <p-message *ngIf="cartItems.length === 0" severity="info" text="Your cart is empty" class="w-full justify-center"></p-message>
</div>